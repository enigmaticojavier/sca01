<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="Ubigeo">

  <typeAlias alias="Ubigeo" type="gob.pe.minam.sca.pojo.Ubigeo"/>
  
  <resultMap id="UbigeoRSMap" class="Ubigeo">
    <result property="ubigeoId" column="UBIGEOID"/>
    <result property="txtDescripcion" column="TXTDESCRIPCION"/>
    <result property="txtDescripcionLarga" column="TXTDESCRIPCIONLARGA"/>
  </resultMap>
  
  <resultMap id="DptoRSMap" class="Ubigeo">
    <result property="codDepartamento" column="UBIGEOID"/>
    <result property="txtDescripcion" column="TXTDESCRIPCION"/>
    <result property="txtDescripcionLarga" column="TXTDESCRIPCIONLARGA"/>
  </resultMap>
  
   <resultMap id="ProvRSMap" class="Ubigeo">
    <result property="codProvincia" column="UBIGEOID"/>
    <result property="txtDescripcion" column="TXTDESCRIPCION"/>
    <result property="txtDescripcionLarga" column="TXTDESCRIPCIONLARGA"/>
  </resultMap>
  
  <resultMap id="DistRSMap" class="Ubigeo">
    <result property="codDistrito" column="UBIGEOID"/>
    <result property="txtDescripcion" column="TXTDESCRIPCION"/>
    <result property="txtDescripcionLarga" column="TXTDESCRIPCIONLARGA"/>
  </resultMap>
  
  <select id="selectAllUbigeo" resultMap="UbigeoRSMap">
    select * from UBIGEO
  </select>

  <select id="getUbigeoByKey" parameterClass="int" resultClass="Ubigeo">
    select * from UBIGEO
    where UBIGEOID = #ubigeoId#
  </select>
   
  <select id="selectDepartamento" parameterClass="int" resultMap="DptoRSMap">
    SELECT * FROM UBIGEO  
    WHERE SUBSTR(UBIGEOID,3,4)='0000' ORDER BY TXTDESCRIPCION
  </select>
  <select id="selectProvincia" parameterClass="Ubigeo" resultMap="ProvRSMap">
    SELECT * FROM UBIGEO  
    WHERE SUBSTR(UBIGEOID,1,2)=#codDepartamento#
       AND SUBSTR(UBIGEOID,3,2) &lt; &gt;'00'
       AND SUBSTR(UBIGEOID,5,2)='00' ORDER BY TXTDESCRIPCION
  </select>
  <select id="selectDistrito" parameterClass="Ubigeo" resultMap="DistRSMap">
    SELECT * FROM UBIGEO  
    WHERE SUBSTR(UBIGEOID,1,2)=#codDepartamento#
        AND SUBSTR(UBIGEOID,3,2)=#codProvincia#
        AND SUBSTR(UBIGEOID,5,2)&lt; &gt;'00' ORDER BY TXTDESCRIPCION   
  </select>
</sqlMap>