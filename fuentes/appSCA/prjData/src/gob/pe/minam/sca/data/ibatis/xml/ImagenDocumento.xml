<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="ImagenDocumento">

  <typeAlias alias="ImagenDocumento" type="gob.pe.minam.sca.pojo.ImagenDocumento"/>
  
  <insert id="insertImagenDocumento" parameterClass="ImagenDocumento">
    insert into imagendocumento(
        nsecuencia,
        docid,
        txtrutaimagen,
        txtnomarchivo
    )values(
        SQ_IMAGENDOCUMENTO.NEXTVAL,
        #documento.docId#,
        #txtRutaImagen#
        #txtNomArchivo#
    )
  </insert>
  
  <update id="updateImagenDocumento" parameterClass="ImagenDocumento">
    update imagendocumento
    set nsecuencia=#nsecuencia#,
        docid=#documento.docId#,
        txtrutaimagen=#txtRutaImagen#,
        txtnomarchivo=#txtNomArchivo#
    where nsecuencia=#nsecuencia#
  </update>
  
  <resultMap id="ImagenDocumentoResult" class="ImagenDocumento">
      <result property="documento.docId" column="docid"/>
      <result property="nsecuencia" column="nsecuencia"/>
      <result property="txtNomArchivo" column="txtnomarchivo"/>
      <result property="txtRutaImagen" column="txtrutaimagen"/>
  </resultMap>
  
  <select id="BuscarImagenXDoc" parameterClass="int" resultMap="ImagenDocumentoResult">
      select docid,
             nsecuencia,
             txtnomarchivo,
             txtrutaimagen
      from imagendocumento
      where docid=#docid#
  </select>
  
  <select id="ExisteImagenDocumento" parameterClass="int" resultClass="int">
      select count(*) cont
      from imagendocumento
      where docid=#param#
  </select>
  

</sqlMap>
